var q=Object.defineProperty;var Z=(a,t,e)=>t in a?q(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var l=(a,t,e)=>(Z(a,typeof t!="symbol"?t+"":t,e),e);const $=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function e(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(n){if(n.ep)return;n.ep=!0;const c=e(n);fetch(n.href,c)}};$();class j{constructor(){l(this,"throttleTime",10)}onResizeEvent(t){window.addEventListener("resize",t)}onKeydownEvent(t){window.addEventListener("keydown",t)}onKeyupEvent(t){window.addEventListener("keyup",t)}onKeypressEvent(t){window.addEventListener("keypress",t)}onMouseDownEvent(t){s.canvas.addEventListener("mousedown",t)}onMouseMoveEvent(t){s.canvas.addEventListener("mousemove",this.throttle(t,this.throttleTime))}onMouseUpEvent(t){s.canvas.addEventListener("mouseup",t)}onMouseLeaveEvent(t){s.canvas.addEventListener("mouseleave",t)}onWheelEvent(t){s.canvas.addEventListener("wheel",t)}onTouchStartEvent(t){s.canvas.addEventListener("touchstart",t)}onTouchMoveEvent(t){s.canvas.addEventListener("touchmove",this.throttle(t,this.throttleTime))}onTouchEndEvent(t){s.canvas.addEventListener("touchend",t)}onContextMenuEvent(t){s.canvas.addEventListener("contextmenu",t)}throttle(t,e){let r=!1;return function(n){r||(t.apply(null,[n]),r=!0,setTimeout(function(){r=!1},e))}}}class i{static toScreenX(t){return(t+this.offsetX)*this.scale}static toScreenY(t){return(t+this.offsetY)*this.scale}static toWorldX(t){return t/this.scale-this.offsetX}static toWorldY(t){return t/this.scale-this.offsetY}static getWidth(){return s.canvas.clientWidth/this.scale}static getHeight(){return s.canvas.clientHeight/this.scale}}l(i,"offsetX",0),l(i,"offsetY",0),l(i,"cursorX",0),l(i,"cursorY",0),l(i,"prevCursorX",0),l(i,"prevCursorY",0),l(i,"scale",1),l(i,"prevTouches",[null,null]);class F{constructor(t){l(this,"properties");l(this,"type",g.Circle);l(this,"worldCenterX");l(this,"worldCenterY");l(this,"radiusX");l(this,"radiusY");this.properties=t,this.worldCenterX=0,this.worldCenterY=0,this.radiusX=0,this.radiusY=0}startDraw(t){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*i.scale;const e=t instanceof MouseEvent?t.pageX:t.touches[0].pageX,r=t instanceof MouseEvent?t.pageY:t.touches[0].pageY;this.properties.initialX=e,this.properties.initialY=r}draw(t){s.clearCanvas(),s.reDraw(),s.ctx.beginPath();const e=t instanceof MouseEvent?t.pageX:t.touches[0].pageX,r=t instanceof MouseEvent?t.pageY:t.touches[0].pageY;let n=(e-this.properties.initialX)/2,c=(r-this.properties.initialY)/2;if(s.isPerfectShape){const p=Math.min(Math.abs(n),Math.abs(c)),w=n<0?-1:1,f=c<0?-1:1;n=p*w,c=p*f}let h=this.properties.initialX+n,d=this.properties.initialY+c;n=Math.abs(n),c=Math.abs(c),this.worldCenterX=i.toWorldX(h),this.worldCenterY=i.toWorldY(d),this.radiusX=n/i.scale,this.radiusY=c/i.scale,s.ctx.ellipse(h,d,n,c,0,0,2*Math.PI),s.ctx.stroke(),s.ctx.closePath()}reDraw(){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*i.scale,s.ctx.ellipse(i.toScreenX(this.worldCenterX),i.toScreenY(this.worldCenterY),this.radiusX*i.scale,this.radiusY*i.scale,0,0,2*Math.PI),s.ctx.stroke()}cancelDraw(){s.clearCanvas(),s.reDraw()}endDraw(){s.ctx.closePath()}isEmpty(){return this.radiusX===0&&this.radiusY===0}}class T{constructor(t){l(this,"line");l(this,"initialRealX");l(this,"initialRealY");l(this,"properties");l(this,"type",g.HandDrawing);this.line=[],this.initialRealX=0,this.initialRealY=0,this.properties=t}cancelDraw(){this.line=[]}startDraw(t){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*i.scale,s.ctx.lineCap="round",s.ctx.lineJoin="round",s.ctx.beginPath();const e=t instanceof MouseEvent?t.pageX:t.touches[0].pageX,r=t instanceof MouseEvent?t.pageY:t.touches[0].pageY;this.properties.initialX=e,this.properties.initialY=r,this.initialRealX=i.toWorldX(e),this.initialRealY=i.toWorldY(r)}draw(t){const e=t instanceof MouseEvent?t.pageX:t.touches[0].pageX,r=t instanceof MouseEvent?t.pageY:t.touches[0].pageY;if(s.clearCanvas(),s.reDraw(),s.ctx.beginPath(),s.isPerfectShape)s.ctx.moveTo(this.properties.initialX,this.properties.initialY),s.ctx.lineTo(e,r);else{let n=[this.initialRealX,this.initialRealY];this.line.push([i.toWorldX(e),i.toWorldY(r)]);let c=this.line[0];for(let h=1;h<this.line.length;h++){let d=this.midPoint(n,c);s.ctx.quadraticCurveTo(i.toScreenX(n[0]),i.toScreenY(n[1]),i.toScreenX(d[0]),i.toScreenY(d[1])),n=this.line[h],c=this.line[h+1]}}s.ctx.stroke(),s.ctx.closePath()}midPoint(t,e){return[t[0]+(e[0]-t[0])/2,t[1]+(e[1]-t[1])/2]}reDraw(){if(this.line.length>2){s.ctx.beginPath();let t=[this.initialRealX,this.initialRealY],e=this.line[0];s.ctx.moveTo(i.toScreenX(this.initialRealX),i.toScreenY(this.initialRealY));for(let r=1;r<this.line.length;r++){let n=this.midPoint(t,e);s.ctx.quadraticCurveTo(i.toScreenX(t[0]),i.toScreenY(t[1]),i.toScreenX(n[0]),i.toScreenY(n[1])),t=this.line[r],e=this.line[r+1]}s.ctx.stroke(),s.ctx.closePath()}else{for(let t=0;t<this.line.length;t++)s.ctx.lineTo(i.toScreenX(this.line[t][0]),i.toScreenY(this.line[t][1]));s.ctx.stroke()}}endDraw(t){if(s.isPerfectShape){const e=t instanceof MouseEvent?t.pageX:t.changedTouches[0].pageX,r=t instanceof MouseEvent?t.pageY:t.changedTouches[0].pageY;this.line=[];const n=[i.toWorldX(e),i.toWorldY(r)];this.line.push([i.toWorldX(this.properties.initialX),i.toWorldY(this.properties.initialY)]),this.line.push(n)}this.line.length>2&&(this.line=this.normalizeArray(this.line)),s.ctx.closePath()}isEmpty(){return this.line.length===0}normalizeArray(t){let e=[];return e=t.filter((r,n)=>{if(n===0)return!0;if(n===t.length-1)return!1;const c=t[n-1];return!(c[0]===r[0]||c[1]===r[1])}),e.push([t[t.length-1][0],t[t.length-1][1]]),e}}class G{constructor(t){l(this,"properties");l(this,"type",g.Rectangle);l(this,"initialRealX");l(this,"initialRealY");l(this,"width");l(this,"height");this.properties=t,this.initialRealX=0,this.initialRealY=0,this.width=0,this.height=0}startDraw(t){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*i.scale;const e=t instanceof MouseEvent?t.pageX:t.touches[0].pageX,r=t instanceof MouseEvent?t.pageY:t.touches[0].pageY;this.properties.initialX=e,this.properties.initialY=r,this.initialRealX=i.toWorldX(e),this.initialRealY=i.toWorldY(r)}draw(t){s.clearCanvas(),s.reDraw(),s.ctx.beginPath();const e=t instanceof MouseEvent?t.pageX:t.touches[0].pageX,r=t instanceof MouseEvent?t.pageY:t.touches[0].pageY;let n=e-this.properties.initialX,c=r-this.properties.initialY;if(s.isPerfectShape){const h=Math.min(Math.abs(n),Math.abs(c));let d=c<0?-1:1,p=n<0?-1:1;n=h*p,c=h*d}this.width=n/i.scale,this.height=c/i.scale,s.ctx.rect(this.properties.initialX,this.properties.initialY,n,c),s.ctx.stroke(),s.ctx.closePath()}reDraw(){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*i.scale,s.ctx.rect(i.toScreenX(this.initialRealX),i.toScreenY(this.initialRealY),this.width*i.scale,this.height*i.scale),s.ctx.stroke()}cancelDraw(){s.clearCanvas(),s.reDraw()}endDraw(){s.ctx.closePath()}isEmpty(){return this.width===0&&this.height===0}}class C{static create(t,e={}){switch(t){case g.HandDrawing:return new T(e);case g.Rectangle:return new G(e);case g.Circle:return new F(e);default:return new T(e)}}}var g=(a=>(a.HandDrawing="HandDrawing",a.Rectangle="Rectangle",a.Circle="Circle",a))(g||{});const k=document.getElementById("color"),v=document.getElementById("size"),P=v.nextElementSibling,L=document.getElementById("drawables"),Q=(a,t)=>{let e=a.parentElement;for(;e!==null;){if(e.tagName===t)return e;e=e.parentElement}return a},V=()=>{const a=localStorage.getItem("history");a!==null&&(JSON.parse(a).forEach(e=>{const r=e.type,n=C.create(r);Object.assign(n,e),s.history.push(n)}),s.reDraw())},D=()=>{localStorage.setItem("history",JSON.stringify(s.history))},R={strokeColor:"#000000",lineWidth:10,fillColor:"#000000",currentDrawable:"HandDrawing"},u=new Proxy(R,{get:(a,t)=>a[t],set:(a,t,e)=>{switch(t){case"strokeColor":a.strokeColor=e,k.value=e,s.ctx.strokeStyle=e;break;case"lineWidth":a.lineWidth=e,v.value=e,P.value=e,s.ctx.lineWidth=e;break;case"fillColor":a.fillColor=e,s.ctx.fillStyle=e;break;case"currentDrawable":a.currentDrawable=e,et();break}return tt(),!0}}),_=()=>{s.ctx.lineJoin="round",s.ctx.lineCap="round";const a=localStorage.getItem("config");if(a!==null){const t=JSON.parse(a);Object.assign(u,t)}},tt=()=>{localStorage.setItem("config",JSON.stringify(R))},et=()=>{L.childNodes.forEach(a=>{if(a.nodeType===Node.ELEMENT_NODE){const t=a;t.classList.remove("selected_draw"),t.dataset.type===u.currentDrawable&&t.classList.add("selected_draw")}})},it=()=>{v.addEventListener("input",t=>{const e=t.target;u.lineWidth=Number(e.value)}),P.addEventListener("input",t=>{const e=t.target;if(Number(e.value)>50){u.lineWidth=50;return}else if(Number(e.value)<1){u.lineWidth=1;return}u.lineWidth=Number(e.value)}),k.addEventListener("change",({target:t})=>{u.strokeColor=t.value}),document.getElementById("clear").addEventListener("click",()=>{s.clearBoard()}),document.getElementById("undo").addEventListener("click",()=>{s.undo()});const a=document.getElementById("download");a.addEventListener("click",()=>{a.setAttribute("download","image.png"),a.setAttribute("href",s.canvas.toDataURL("image/png"))}),L.addEventListener("click",t=>{let e=t.target;e.tagName!=="BUTTON"&&(e=Q(e,"BUTTON"));const r=e.dataset.type;r!==void 0&&(u.currentDrawable=r)}),window.addEventListener("load",()=>{_(),V()})},o=class extends j{constructor(){super();l(this,"isDrawing");l(this,"isDragging");l(this,"timer",0);l(this,"currentDraw",null);o.canvas=document.getElementById("canvas"),o.ctx=o.canvas.getContext("2d"),o.canvas.width=document.body.clientWidth,o.canvas.height=document.body.clientHeight,this.isDrawing=!1,this.isDragging=!1,this.createDrawable(),o.clearCanvas()}initilizeEvents(){this.onResizeEvent(this.onResize.bind(this)),this.onMouseDownEvent(this.onMouseDown.bind(this)),this.onMouseMoveEvent(this.onMouseMove.bind(this)),this.onMouseUpEvent(this.onMouseUp.bind(this)),this.onMouseLeaveEvent(this.onMouseUp.bind(this)),this.onContextMenuEvent(this.onContextMenu.bind(this)),this.onWheelEvent(this.onMouseWheel.bind(this)),this.onTouchStartEvent(this.onTouchStart.bind(this)),this.onTouchMoveEvent(this.onTouchMove.bind(this)),this.onTouchEndEvent(this.onTouchEnd.bind(this)),this.onKeydownEvent(this.onKeyDown.bind(this)),it()}onContextMenu(e){e.preventDefault()}onResize(){o.canvas.width=document.body.clientWidth,o.canvas.height=document.body.clientHeight,o.reDraw()}static reDraw(){o.history.length!=0&&(o.clearCanvas(),o.history.forEach(e=>{o.ctx.strokeStyle=e.properties.strokeColor,o.ctx.lineWidth=e.properties.lineWidth*i.scale,o.ctx.moveTo(e.properties.initialX,e.properties.initialY),o.ctx.beginPath(),e.reDraw(),o.ctx.closePath()}),o.ctx.strokeStyle=u.strokeColor,o.ctx.lineWidth=u.lineWidth*i.scale)}draw(e){var r;this.isDrawing&&(clearTimeout(this.timer),o.isPerfectShape||(this.timer=setTimeout(()=>{var n;o.isPerfectShape=!0,(n=this.currentDraw)==null||n.draw(e)},600)),(r=this.currentDraw)==null||r.draw(e))}endDraw(e){var r,n;this.isDrawing&&((r=this.currentDraw)==null||r.endDraw(e),(n=this.currentDraw)!=null&&n.isEmpty()||(o.history.push(this.currentDraw),D())),this.isDrawing=!1,this.isDragging=!1,o.isPerfectShape=!1,clearTimeout(this.timer)}onMouseDown(e){var r;e.preventDefault(),this.isDrawing=e.button==0,this.isDragging=e.button==1,i.cursorX=e.pageX,i.cursorY=e.pageY,i.prevCursorX=e.pageX,i.prevCursorY=e.pageY,this.isDrawing&&(this.createDrawable(),(r=this.currentDraw)==null||r.startDraw(e))}onMouseMove(e){i.cursorX=e.pageX,i.cursorY=e.pageY,this.draw(e),this.isDragging&&(i.offsetX+=(i.cursorX-i.prevCursorX)/i.scale,i.offsetY+=(i.cursorY-i.prevCursorY)/i.scale,o.reDraw()),i.prevCursorX=i.cursorX,i.prevCursorY=i.cursorY}onMouseUp(e){this.endDraw(e)}onMouseWheel(e){var Y;if(this.isDrawing){(Y=this.currentDraw)==null||Y.cancelDraw(),this.createDrawable(),this.isDrawing=!1,this.isDragging=!1;return}const n=-e.deltaY/500,c=i.scale*(1+n);if(c<.1||c>10)return;i.scale=c;var h=e.pageX/o.canvas.clientWidth,d=e.pageY/o.canvas.clientHeight;const p=i.getWidth()*n,w=i.getHeight()*n,f=p*h,X=w*d;i.offsetX-=f,i.offsetY-=X,o.reDraw()}onTouchStart(e){var r;this.isDrawing=e.touches.length==1,this.isDragging=e.touches.length>=2,i.prevTouches[0]=e.touches[0],i.prevTouches[1]=e.touches[1],this.createDrawable(),(r=this.currentDraw)==null||r.startDraw(e)}onTouchMove(e){var f,X,Y;if(i.prevTouches[0]===null||i.prevTouches[1]===null)return;const r=e.touches[0].pageX,n=e.touches[0].pageY,c=i.prevTouches[0].pageX,h=i.prevTouches[0].pageY;if(this.draw(e),this.isDragging){if(this.isDrawing){(f=this.currentDraw)==null||f.cancelDraw(),this.createDrawable(),this.isDrawing=!1,this.isDragging=!1;return}e.preventDefault();const m=e.touches[1].pageX,E=e.touches[1].pageY,x=(X=i.prevTouches[1])==null?void 0:X.pageX,b=(Y=i.prevTouches[1])==null?void 0:Y.pageY,M=(r+m)/2,S=(n+E)/2,N=(c+x)/2,H=(h+b)/2,I=Math.sqrt(Math.pow(r-m,2)+Math.pow(n-E,2)),O=Math.sqrt(Math.pow(c-x,2)+Math.pow(h-b,2));var d=I/O;const y=i.scale*d;if(y<.1||y>10)return;i.scale=y;const W=1-d,z=M-N,A=S-H;i.offsetX+=z/i.scale,i.offsetY+=A/i.scale;var p=M/o.canvas.clientWidth,w=S/o.canvas.clientHeight;const B=i.getWidth()*W,U=i.getHeight()*W,K=B*p,J=U*w;i.offsetX+=K,i.offsetY+=J,o.reDraw()}i.prevTouches[0]=e.touches[0],i.prevTouches[1]=e.touches[1]}onTouchEnd(e){this.endDraw(e),i.prevTouches[0]=null,i.prevTouches[1]=null}onKeyDown(e){e.ctrlKey&&(e.key===""||e.key==="z")&&o.undo()}static undo(){o.history.length!==0&&(o.clearCanvas(),o.history.pop(),D(),o.reDraw())}static clearBoard(){o.clearCanvas(),o.history=[],D()}createDrawable(){this.currentDraw=C.create(u.currentDrawable,{strokeColor:u.strokeColor,lineWidth:u.lineWidth})}static clearCanvas(e=null){o.ctx.fillStyle="#fff",e===null?o.ctx.fillRect(0,0,document.body.clientWidth,document.body.clientHeight):o.ctx.fillRect(e.prevX,e.prevY,e.x,e.y),o.ctx.fillStyle=u.fillColor}};let s=o;l(s,"canvas"),l(s,"ctx"),l(s,"isPerfectShape",!1),l(s,"history",[]);const st=new s;st.initilizeEvents();
