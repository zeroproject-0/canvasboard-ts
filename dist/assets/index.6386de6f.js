var N=Object.defineProperty;var K=(r,e,t)=>e in r?N(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e,t)=>(K(r,typeof e!="symbol"?e+"":e,t),t);const O=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerpolicy&&(c.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?c.credentials="include":a.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(a){if(a.ep)return;a.ep=!0;const c=t(a);fetch(a.href,c)}};O();class Z{constructor(){o(this,"throttleTime",10)}onResizeEvent(e){window.addEventListener("resize",e)}onKeydownEvent(e){window.addEventListener("keydown",e)}onKeyupEvent(e){window.addEventListener("keyup",e)}onKeypressEvent(e){window.addEventListener("keypress",e)}onMouseDownEvent(e){s.canvas.addEventListener("mousedown",e)}onMouseMoveEvent(e){s.canvas.addEventListener("mousemove",this.throttle(e,this.throttleTime))}onMouseUpEvent(e){s.canvas.addEventListener("mouseup",e)}onMouseLeaveEvent(e){s.canvas.addEventListener("mouseleave",e)}onWheelEvent(e){s.canvas.addEventListener("wheel",e)}onTouchStartEvent(e){s.canvas.addEventListener("touchstart",e)}onTouchMoveEvent(e){s.canvas.addEventListener("touchmove",this.throttle(e,this.throttleTime))}onTouchEndEvent(e){s.canvas.addEventListener("touchend",e)}onContextMenuEvent(e){s.canvas.addEventListener("contextmenu",e)}throttle(e,t){let i=!1;return function(a){i||(e.apply(null,[a]),i=!0,setTimeout(function(){i=!1},t))}}}class q{constructor(e){o(this,"properties");o(this,"worldCenterX");o(this,"worldCenterY");o(this,"radiusX");o(this,"radiusY");this.properties=e,this.worldCenterX=0,this.worldCenterY=0,this.radiusX=0,this.radiusY=0}startDraw(e){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*s.canvasConfig.scale;const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,i=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;this.properties.initialX=t,this.properties.initialY=i}draw(e){s.clearCanvas(),s.reDraw(),s.ctx.beginPath();const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,i=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;let a=(t-this.properties.initialX)/2,c=(i-this.properties.initialY)/2;const l=this.properties.initialX+a,u=this.properties.initialY+c;a=Math.abs(a),c=Math.abs(c),this.worldCenterX=s.canvasConfig.toWorldX(l),this.worldCenterY=s.canvasConfig.toWorldY(u),this.radiusX=a/s.canvasConfig.scale,this.radiusY=c/s.canvasConfig.scale,s.ctx.ellipse(l,u,a,c,0,0,2*Math.PI),s.ctx.stroke(),s.ctx.closePath()}reDraw(){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*s.canvasConfig.scale,s.ctx.ellipse(s.canvasConfig.toScreenX(this.worldCenterX),s.canvasConfig.toScreenY(this.worldCenterY),this.radiusX*s.canvasConfig.scale,this.radiusY*s.canvasConfig.scale,0,0,2*Math.PI),s.ctx.stroke()}cancelDraw(){s.clearCanvas(),s.reDraw()}endDraw(){s.ctx.closePath()}}class T{constructor(e){o(this,"line");o(this,"prevX",0);o(this,"prevY",0);o(this,"properties");this.line=[],this.properties=e}cancelDraw(){this.line=[]}startDraw(){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*s.canvasConfig.scale,s.ctx.lineCap="round",s.ctx.lineJoin="round",s.ctx.beginPath(),this.properties.initialX=s.canvasConfig.cursorX,this.properties.initialY=s.canvasConfig.cursorY}draw(e){const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,i=e instanceof MouseEvent?e.pageY:e.touches[0].pageY,a=[s.canvasConfig.toWorldX(t),s.canvasConfig.toWorldY(i)];s.ctx.lineTo(t,i),this.line.push(a),s.ctx.stroke()}reDraw(){for(let e=0;e<this.line.length;e++)s.ctx.lineTo(s.canvasConfig.toScreenX(this.line[e][0]),s.canvasConfig.toScreenY(this.line[e][1]));s.ctx.stroke()}endDraw(){s.ctx.closePath()}}class F{constructor(e){o(this,"properties");o(this,"initialRealX");o(this,"initialRealY");o(this,"width");o(this,"height");this.properties=e,this.initialRealX=0,this.initialRealY=0,this.width=0,this.height=0}startDraw(e){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*s.canvasConfig.scale;const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,i=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;this.properties.initialX=t,this.properties.initialY=i,this.initialRealX=s.canvasConfig.toWorldX(t),this.initialRealY=s.canvasConfig.toWorldY(i)}draw(e){s.clearCanvas(),s.reDraw(),s.ctx.beginPath();const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,i=e instanceof MouseEvent?e.pageY:e.touches[0].pageY,a=t-this.properties.initialX,c=i-this.properties.initialY;this.width=a/s.canvasConfig.scale,this.height=c/s.canvasConfig.scale,s.ctx.rect(this.properties.initialX,this.properties.initialY,a,c),s.ctx.stroke(),s.ctx.closePath()}reDraw(){s.ctx.strokeStyle=this.properties.strokeColor,s.ctx.lineWidth=this.properties.lineWidth*s.canvasConfig.scale,s.ctx.rect(s.canvasConfig.toScreenX(this.initialRealX),s.canvasConfig.toScreenY(this.initialRealY),this.width*s.canvasConfig.scale,this.height*s.canvasConfig.scale),s.ctx.stroke()}cancelDraw(){s.clearCanvas(),s.reDraw()}endDraw(){s.ctx.closePath()}}class J{static create(e,t){switch(e){case h.HandDrawing:return new T(t);case h.Rectangle:return new F(t);case h.Circle:return new q(t);default:return new T(t)}}}var h=(r=>(r[r.HandDrawing=0]="HandDrawing",r[r.Rectangle=1]="Rectangle",r[r.Circle=2]="Circle",r))(h||{});const j={pen:h.HandDrawing,rectangle:h.Rectangle,circle:h.Circle},G=(r,e)=>{let t=r.parentElement;for(;t!==null;){if(t.tagName===e)return t;t=t.parentElement}return r};let w="#000000",Y=10,Q="#000000",W=h.HandDrawing;const V=()=>{document.getElementById("size").addEventListener("change",t=>{const i=t.target,a=i.nextElementSibling;a.textContent=i.value,Y=Number(i.value)}),document.getElementById("color").addEventListener("change",({target:t})=>{w=t.value}),document.getElementById("clear").addEventListener("click",()=>{s.clearBoard()}),document.getElementById("undo").addEventListener("click",()=>{s.undo()});const r=document.getElementById("download");r.addEventListener("click",()=>{r.setAttribute("download","image.png"),r.setAttribute("href",s.canvas.toDataURL("image/png"))}),document.getElementById("drawables").addEventListener("click",t=>{let i=t.target;i.tagName!=="BUTTON"&&(i=G(i,"BUTTON"));const a=i.dataset.type;a!==void 0&&(W=j[a])})};class k{constructor(){o(this,"offsetX");o(this,"offsetY");o(this,"cursorX");o(this,"cursorY");o(this,"prevCursorX");o(this,"prevCursorY");o(this,"scale");o(this,"prevTouches",[null,null]);this.offsetX=0,this.offsetY=0,this.cursorX=0,this.cursorY=0,this.prevCursorX=0,this.prevCursorY=0,this.scale=1}static get getInstance(){return this._instance||(this._instance=new this)}toScreenX(e){return(e+this.offsetX)*this.scale}toScreenY(e){return(e+this.offsetY)*this.scale}toWorldX(e){return e/this.scale-this.offsetX}toWorldY(e){return e/this.scale-this.offsetY}getWidth(){return s.canvas.clientWidth/this.scale}getHeight(){return s.canvas.clientHeight/this.scale}}o(k,"_instance");const n=class extends Z{constructor(){super();o(this,"isDrawing");o(this,"isDragging");o(this,"currentDraw",null);n.canvas=document.getElementById("canvas"),n.ctx=n.canvas.getContext("2d"),n.canvas.width=document.body.clientWidth,n.canvas.height=document.body.clientHeight,this.isDrawing=!1,this.isDragging=!1,V(),n.canvasConfig=k.getInstance,this.createDrawable(),n.clearCanvas()}initilizeEvents(){this.onResizeEvent(this.onResize.bind(this)),this.onMouseDownEvent(this.onMouseDown.bind(this)),this.onMouseMoveEvent(this.onMouseMove.bind(this)),this.onMouseUpEvent(this.onMouseUp.bind(this)),this.onMouseLeaveEvent(this.onMouseUp.bind(this)),this.onContextMenuEvent(this.onContextMenu.bind(this)),this.onWheelEvent(this.onMouseWheel.bind(this)),this.onTouchStartEvent(this.onTouchStart.bind(this)),this.onTouchMoveEvent(this.onTouchMove.bind(this)),this.onTouchEndEvent(this.onTouchEnd.bind(this)),this.onKeydownEvent(this.onKeyDown.bind(this))}onContextMenu(t){t.preventDefault()}onResize(){n.canvas.width=document.body.clientWidth,n.canvas.height=document.body.clientHeight,n.reDraw()}static reDraw(){n.history.length!=0&&(n.clearCanvas(),n.history.forEach(t=>{n.ctx.strokeStyle=t.properties.strokeColor,n.ctx.lineWidth=t.properties.lineWidth*n.canvasConfig.scale,n.ctx.moveTo(t.properties.initialX,t.properties.initialY),n.ctx.beginPath(),t.reDraw(),n.ctx.closePath()}),n.ctx.strokeStyle=w,n.ctx.lineWidth=Y*n.canvasConfig.scale)}onMouseDown(t){var i;t.preventDefault(),this.isDrawing=t.button==0,this.isDragging=t.button==1,n.canvasConfig.cursorX=t.pageX,n.canvasConfig.cursorY=t.pageY,n.canvasConfig.prevCursorX=t.pageX,n.canvasConfig.prevCursorY=t.pageY,this.isDrawing&&(this.createDrawable(),(i=this.currentDraw)==null||i.startDraw(t))}onMouseMove(t){var i;n.canvasConfig.cursorX=t.pageX,n.canvasConfig.cursorY=t.pageY,this.isDrawing&&((i=this.currentDraw)==null||i.draw(t)),this.isDragging&&(n.canvasConfig.offsetX+=(n.canvasConfig.cursorX-n.canvasConfig.prevCursorX)/n.canvasConfig.scale,n.canvasConfig.offsetY+=(n.canvasConfig.cursorY-n.canvasConfig.prevCursorY)/n.canvasConfig.scale,n.reDraw()),n.canvasConfig.prevCursorX=n.canvasConfig.cursorX,n.canvasConfig.prevCursorY=n.canvasConfig.cursorY}onMouseUp(t){var i;this.isDrawing&&((i=this.currentDraw)==null||i.endDraw(t),n.history.push(this.currentDraw)),this.isDrawing=!1,this.isDragging=!1}onMouseWheel(t){var g;if(this.isDrawing){(g=this.currentDraw)==null||g.cancelDraw(),this.createDrawable(),this.isDrawing=!1,this.isDragging=!1;return}const a=-t.deltaY/500,c=n.canvasConfig.scale*(1+a);if(c<.1||c>10)return;n.canvasConfig.scale=c;var l=t.pageX/n.canvas.clientWidth,u=t.pageY/n.canvas.clientHeight;const v=n.canvasConfig.getWidth()*a,p=n.canvasConfig.getHeight()*a,d=v*l,f=p*u;n.canvasConfig.offsetX-=d,n.canvasConfig.offsetY-=f,n.reDraw()}onTouchStart(t){var i;this.isDrawing=t.touches.length==1,this.isDragging=t.touches.length>=2,n.canvasConfig.prevTouches[0]=t.touches[0],n.canvasConfig.prevTouches[1]=t.touches[1],this.createDrawable(),(i=this.currentDraw)==null||i.startDraw(t)}onTouchMove(t){var d,f,g,X;if(n.canvasConfig.prevTouches[0]===null||n.canvasConfig.prevTouches[1]===null)return;const i=t.touches[0].pageX,a=t.touches[0].pageY,c=n.canvasConfig.prevTouches[0].pageX,l=n.canvasConfig.prevTouches[0].pageY;if(this.isDrawing&&((d=this.currentDraw)==null||d.draw(t)),this.isDragging){if(this.isDrawing){(f=this.currentDraw)==null||f.cancelDraw(),this.createDrawable(),this.isDrawing=!1,this.isDragging=!1;return}t.preventDefault();const D=t.touches[1].pageX,E=t.touches[1].pageY,y=(g=n.canvasConfig.prevTouches[1])==null?void 0:g.pageX,x=(X=n.canvasConfig.prevTouches[1])==null?void 0:X.pageY,m=(i+D)/2,M=(a+E)/2,L=(c+y)/2,S=(l+x)/2,R=Math.sqrt(Math.pow(i-D,2)+Math.pow(a-E,2)),H=Math.sqrt(Math.pow(c-y,2)+Math.pow(l-x,2));var u=R/H;const C=n.canvasConfig.scale*u;if(C<.1||C>10)return;n.canvasConfig.scale=C;const b=1-u,I=m-L,P=M-S;n.canvasConfig.offsetX+=I/n.canvasConfig.scale,n.canvasConfig.offsetY+=P/n.canvasConfig.scale;var v=m/n.canvas.clientWidth,p=M/n.canvas.clientHeight;const U=n.canvasConfig.getWidth()*b,z=n.canvasConfig.getHeight()*b,A=U*v,B=z*p;n.canvasConfig.offsetX+=A,n.canvasConfig.offsetY+=B,n.reDraw()}n.canvasConfig.prevTouches[0]=t.touches[0],n.canvasConfig.prevTouches[1]=t.touches[1]}onTouchEnd(){n.canvasConfig.prevTouches[0]=null,n.canvasConfig.prevTouches[1]=null,this.onMouseUp(null)}onKeyDown(t){t.ctrlKey&&(t.key===""||t.key==="z")&&n.undo()}static undo(){n.history.length!==0&&(n.clearCanvas(),n.history.pop(),n.reDraw())}static clearBoard(){n.clearCanvas(),n.history=[]}createDrawable(){this.currentDraw=J.create(W,{strokeColor:w,lineWidth:Y})}static clearCanvas(t=null){n.ctx.fillStyle="#fff",t===null?n.ctx.fillRect(0,0,document.body.clientWidth,document.body.clientHeight):n.ctx.fillRect(t.prevX,t.prevY,t.x,t.y),n.ctx.fillStyle=Q}};let s=n;o(s,"canvas"),o(s,"ctx"),o(s,"history",[]),o(s,"canvasConfig");const $=new s;$.initilizeEvents();
